# Filmorate
Template repository for Filmorate project.
## Sprint 12.1 homework


## ER-diagram
[ER-диаграмма](https://dbdiagram.io/d/68242e865b2fc4582f817eb1)
![картинка диаграммы](/updateFLMRT.png)

## Описание таблиц БД
* film
  Содержит данные о фильмах.
  Таблица включает такие поля:
	- первичный ключ film_id — идентификатор фильма;
	- title — название;
	- description — описание;
	- release_date — дата выхода фильма;
	- duration - продолжительность фильма;
	- внешний ключ MPA_id - идентификатор рейтинга фильма.


* users
  Содержит данные о пользователях
  Таблица включает такие поля:
	- первичный ключ user_id — идентификатор пользователя;
	- email — почта;
	- name — имя;
	- birthday — дата рождения;
	- login -логин пользователя.

* film_genre
  Содержит данные о жанрах в фильмах
  Таблица включает такие поля:
	- первичный ключ id — идентификатор жанра в фильме;
	- внешний ключ film_id — идентификатор фильма;
	- genre_id — внешний ключ идентификатора жанра.
* genre
  Содержит данные о жанре
  Таблица включает такие поля:
	- первичный ключ id — идентификатор жанра;
	- name — название жанра.

* likes
  Содержит данные о том, кто поставил лайк фильму
  Таблица включает поля:
	- первичный ключ id_likes - идентификатор поставленного лайка
	- внешний ключ film_id — идентификатор фильма;
	- внешний ключ user_id - идентификатор пользователя.

* friends
  Содержит данные о дружбе пользователей и статуса дружбы
  Таблица включает такие поля:
	- первичный ключ id_friends_list - идентификатор записи дружбы пользователей;
	- внешний ключ user_id - идентификатор пользователя, к которому добавляем друга;
	- внешний ключ friend_id - идентификатор пользователя, кого добавляем в друзья;\
	- friend_confirm - статус дружбы (неподтверждённая / подтверждённая).

* MPA
  Содержит данные о рейтинге
  Таблица включает поля:
	- первичный ключ id - индификатор рейтинга
	- name - название рейтинга.

## Примеры запросов
	1. Топ два фильма по популярности среди пользователей: 
```sql
SELECT f.title, COUNT(l.user_id) AS count_likes
FROM film f
JOIN likes l ON f.film_id = l.film_id
GROUP BY f.film_id
ORDER BY COUNT(l.user_id) desc
LIMIT 2
```

	2. Выгрузка названий фильмов, продолжительность которых не превышает двух часов:
```sql
SELECT title
FROM film
WHERE duration <= 120
```

	3. Название фильмов с жанром "Комедия":
```sql
SELECT f.title
FROM film f
LEFT JOIN film_genre fg ON f.film_id = fg.film_id
JOIN genre g ON fg.genre_id = g.genre_id
WHERE g.name_genre = 'Comedy'
```